<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>VinodFA | Our Story</title>

  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="IMG-20250904-WA0433.jpg" type="image/png">

  <style>
    body { font-family: 'Segoe UI', sans-serif; margin: 0; background: #f4f4f4; color: #333; }
    .section-title { font-size: 2.5rem; color: #0a1a2f; margin: 2rem 0 0.5rem; text-align: center; }
    .section-text { text-align: center; font-size: 1.1rem; margin-bottom: 2rem; color: #555; }

    .swiper { max-width: 1000px; margin: 2rem auto; border-radius: 10px; overflow: hidden; }
    .swiper-slide { position: relative; display: flex; justify-content: center; align-items: center; background: #000; height: 390px; }
    .swiper-slide img, .swiper-slide video { width: 100%; height: 100%; object-fit: cover; display: block; }
    .slide-caption { position: absolute; bottom: 10px; left: 10px; background: rgba(0,0,0,0.6); color: #fff; padding: 0.5rem 1rem; border-radius: 4px; font-size: 1rem; max-width: 90%; }

    .filter-buttons { display: flex; justify-content: center; gap: 1rem; margin-bottom: 2rem; flex-wrap: wrap; }
    .filter-buttons button { padding: 0.6rem 1.2rem; border: none; background: #0a1a2f; color: white; border-radius: 5px; cursor: pointer; transition: background 0.3s ease; font-size: 1rem; }
    .filter-buttons button.active, .filter-buttons button:hover { background: #005bb5; }

    .story-grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 2rem; padding: 0 1rem 4rem; }
    .story-card { background: white; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); max-width: 320px; width: 100%; overflow: hidden; transition: transform 0.3s ease; display: flex; flex-direction: column; }
    .story-card:hover { transform: translateY(-6px); }
    .story-media img, .story-media video { width: 100%; height: 180px; object-fit: cover; display: block; }
    .story-content { padding: 1rem; flex-grow: 1; }
    .story-heading { font-size: 1.2rem; color: #0a1a2f; margin-bottom: 0.5rem; }
    .story-desc { font-size: 0.95rem; color: #555; line-height: 1.4; }

    @media (max-width: 768px) {
      .story-grid { flex-direction: column; align-items: center; }
      .swiper-slide { height: 250px; }
      .story-media img, .story-media video { height: 140px; }
    }
  </style>
</head>
<body>
  <header class="header" id="header">
    <a href="index.html" class="logo-link"><span>Vinod</span> Football Academy</a>
    <nav class="navigation" id="navigation">
      <a href="index.html" class="link">Home</a>
      <a href="#" class="link">Story</a>
      <a href="community.html" class="link">Community</a>
      <a href="contact.html" class="link">Contact us</a>
    </nav>
    <p>Highlight Reels â€¢ Player Achievements â€¢ Match Stories</p>
    <button id="darkModeToggle" class="dark-toggle"><i class='bx bx-moon'></i></button>
  </header>

  <!-- Dynamic Swiper -->
  <section>
    <div class="swiper mySwiper">
      <div class="swiper-wrapper" id="swiperWrapper">
        <!-- highlight stories will load here -->
      </div>
      <div class="swiper-button-next"></div>
      <div class="swiper-button-prev"></div>
      <div class="swiper-pagination"></div>
    </div>
  </section>

  <!-- Story Section -->
  <section>
    <h2 class="section-title">Our Story</h2>
    <p class="section-text">Explore the passion, moments, and milestones that define us.</p>

    <div class="filter-buttons">
      <button class="active" data-category="all">All</button>
      <button data-category="highlight">Highlights</button>
      <button data-category="player">Players</button>
      <button data-category="achievement">Achievements</button>
    </div>

    <div class="story-grid"></div>
  </section>

  <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
  import { 
    getFirestore, 
    collection, 
    onSnapshot, 
    query, 
    orderBy, 
    where, 
    limit 
  } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCRQUjX6hPd79gFmrySgzjHwgeP61-1myI",
    authDomain: "vinodfa-b085a.firebaseapp.com",
    projectId: "vinodfa-b085a",
    storageBucket: "vinodfa-b085a.appspot.com",
    messagingSenderId: "692083333518",
    appId: "1:692083333518:web:2b32948d357e5067222cdf"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  let allStories = [];

  // ðŸ”¥ Realtime Stories
  function loadStories() {
    const q = query(collection(db, "stories"), orderBy("createdAt", "desc"));
    onSnapshot(q, (snapshot) => {
      allStories = snapshot.docs.map(doc => doc.data());
      displayStories(document.querySelector(".filter-buttons button.active")?.dataset.category || "all");

      const loader = document.getElementById("page-loader");
      if (loader) loader.style.display = "none";
    });
  }

  function displayStories(category) {
    const grid = document.querySelector(".story-grid");
    grid.innerHTML = "";

    allStories.forEach(story => {
      if (category === "all" || story.category === category) {
        const card = document.createElement("div");
        card.classList.add("story-card");
        card.setAttribute("data-category", story.category);

        const media = story.mediaBase64 || "default-news.jpg";
        const isVideo = media.startsWith("data:video");

        card.innerHTML = `
          <div class="story-media">
            ${isVideo 
              ? `<video src="${media}" controls></video>` 
              : `<img src="${media}" alt="${story.title}">`}
          </div>
          <div class="story-content">
            <h3 class="story-heading">${story.title}</h3>
            <p class="story-desc">${story.description}</p>
          </div>
        `;
        grid.appendChild(card);
      }
    });
  }

  // ðŸ”¥ Realtime Highlights for Swiper
  function loadHighlights() {
    const q = query(
      collection(db, "stories"), 
      where("category", "==", "highlight"), 
      orderBy("createdAt", "desc"), 
      limit(5)
    );

    onSnapshot(q, (snapshot) => {
      const swiperWrapper = document.getElementById("swiperWrapper");
      swiperWrapper.innerHTML = "";

      snapshot.forEach(doc => {
        const story = doc.data();
        const media = story.mediaBase64 || "default-news.jpg";
        const isVideo = media.startsWith("data:video");

        const slide = document.createElement("div");
        slide.classList.add("swiper-slide");
        slide.innerHTML = `
          ${isVideo 
            ? `<video src="${media}" controls muted playsinline></video>` 
            : `<img src="${media}" alt="${story.title}">`}
          <div class="slide-caption">${story.title}</div>
        `;
        swiperWrapper.appendChild(slide);
      });

      // Re-init Swiper each time highlights update
      new Swiper(".mySwiper", {
        loop: true,
        autoplay: { delay: 5000, disableOnInteraction: false },
        pagination: { el: ".swiper-pagination", clickable: true },
        navigation: { nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev" },
      });
    });
  }

  // Filter buttons
  document.querySelectorAll(".filter-buttons button").forEach(button => {
    button.addEventListener("click", (event) => {
      document.querySelectorAll(".filter-buttons button").forEach(btn => btn.classList.remove("active"));
      event.target.classList.add("active");
      displayStories(event.target.dataset.category);
    });
  });

  loadStories();
  loadHighlights();
</script>



  <div id="page-loader"><div class="spinner"></div></div>
  <script src="script.js"></script>
</body>
</html>
